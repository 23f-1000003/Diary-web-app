<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Digital Diary</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="diary-container">
        <div class="diary-header">
            <h1 class="diary-title">My Digital Diary</h1>
            <div class="user-info">Welcome back, {{ username }}!</div>
            <a href="/logout" class="logout-btn">Logout</a>
        </div>
        
        <div id="currentDate" class="current-date"></div>
        
        <div class="diary-book">
            <div class="diary-page">
                <div class="page-lines"></div>
                <div class="diary-content" id="diaryContent">
                    <textarea 
                        id="diaryText" 
                        placeholder="Dear Diary..."
                        spellcheck="false"
                    ></textarea>
                    
                    <div id="imagesContainer" class="images-container"></div>
                </div>
                
                <div class="page-controls">
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                    <button class="control-btn add-image-btn" onclick="document.getElementById('imageUpload').click()">
                        üì∑ Add Photo
                    </button>
                    
                    <button class="control-btn save-btn" onclick="saveDiary()">
                        üíæ Save Entry
                    </button>
                </div>
            </div>
        </div>
        
        <div class="navigation">
            <button class="nav-btn prev-btn" onclick="changeDate(-1)">
                <span class="nav-icon">‚óÄ</span>
                <span class="nav-text">Previous Day</span>
            </button>
            
            <button class="nav-btn today-btn" onclick="goToToday()">
                Today
            </button>
            
            <button class="nav-btn next-btn" onclick="changeDate(1)">
                <span class="nav-text">Next Day</span>
                <span class="nav-icon">‚ñ∂</span>
            </button>
        </div>
    </div>

    <!-- Image Caption Modal -->
    <div id="captionModal" class="modal">
        <div class="modal-content">
            <h3>Add Caption</h3>
            <input type="text" id="captionInput" placeholder="Write a caption for your photo..." maxlength="200">
            <div class="modal-buttons">
                <button onclick="saveCaptionAndUpload()">Add Photo</button>
                <button onclick="closeCaptionModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Image Controls -->
    <div id="imageControls" class="image-controls" style="display: none;">
        <div class="controls-title">Image Controls</div>
        
        <div class="controls-section">
            <div class="controls-label">Rotate</div>
            <div class="controls-group">
                <button onclick="rotateImage(-15)" title="Rotate Left">‚Ü∫ 15¬∞</button>
                <button onclick="rotateImage(15)" title="Rotate Right">‚Üª 15¬∞</button>
                <button onclick="rotateImage(-5)" title="Fine Rotate Left">‚Ü∫ 5¬∞</button>
                <button onclick="rotateImage(5)" title="Fine Rotate Right">‚Üª 5¬∞</button>
            </div>
        </div>
        
        <div class="controls-section">
            <div class="controls-label">Tilt</div>
            <div class="controls-group">
                <button onclick="tiltImage(-5, 0)" title="Tilt Left">‚ó§</button>
                <button onclick="tiltImage(5, 0)" title="Tilt Right">‚ó•</button>
                <button onclick="tiltImage(0, -5)" title="Tilt Up">‚©ô</button>
                <button onclick="tiltImage(0, 5)" title="Tilt Down">‚©ò</button>
            </div>
            <div class="controls-group">
                <button onclick="resetTilt()" title="Reset Tilt">Reset Tilt</button>
            </div>
        </div>
        
        <div class="controls-section">
            <div class="controls-label">Scale</div>
            <div class="controls-group">
                <button onclick="scaleImage(1.1)" title="Scale Up">üîç+</button>
                <button onclick="scaleImage(0.9)" title="Scale Down">üîç-</button>
            </div>
        </div>
        
        <div class="controls-section">
            <div class="controls-group">
                <button onclick="resetTransforms()" title="Reset All">Reset All</button>
                <button onclick="deleteImage()" title="Delete Image" style="background: #dc3545; color: white;">Delete</button>
            </div>
        </div>
    </div>

    <!-- Notification Element -->
    <div id="notification" class="notification"></div>

    <!-- Help Toggle -->
    <button class="help-toggle" onclick="toggleKeyboardHelp()" title="Keyboard Shortcuts">?</button>

    <!-- Keyboard Help -->
    <div id="keyboardHelp" class="keyboard-help" style="display: none;">
        <h4>Keyboard Shortcuts</h4>
        <ul>
            <li><strong>Ctrl/Cmd + S:</strong> Save diary</li>
            <li><strong>Ctrl/Cmd + ‚Üê/‚Üí:</strong> Previous/Next day</li>
            <li><strong>Ctrl/Cmd + R:</strong> Reset transforms</li>
            <li><strong>Shift + Arrow Keys:</strong> Tilt selected image</li>
            <li><strong>Delete:</strong> Delete selected image</li>
            <li><strong>Escape:</strong> Close controls/modals</li>
        </ul>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>